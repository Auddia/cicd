on:
  push:
    branches:
      - main
  workflow_dispatch:


jobs:
  test_job:
    name: Test Job
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          ref: ${{ github.ref }}

      - name: GCloud SDK Setup
        uses: ./actions/setup_gcloud
        with:
          gcp_credentials: '${{ secrets.TEST_CREDENTIALS_VODACAST_STAGING }}'

      - name: decrypt_kms
        uses: ./actions/decrypt_kms
        with:
          key_ring: cfr
          keys: |
            rails_master_key: ./config/master.key.enc
            cfr_runner_key: ./config/cfr_runner.key.enc
            playstore_verifier_key: ./config/playstore_verifier.key.enc